# app-config.yml - Sample solution for application configuration
---
# Application Metadata
application:
  name: "web-application"
  version: "2.1.0"
  environment: "production"
  description: >
    A scalable web application for customer management
    with integrated analytics and reporting capabilities.
  maintainer: "DevOps Team"
  repository: "https://github.com/company/web-app"

# Database Configuration
database:
  primary:
    host: "db-primary.internal"
    port: 5432
    name: "webapp_prod"
    username: "app_user"
    password_env: "DB_PASSWORD"
    ssl_mode: "require"
    connection_pool:
      min_connections: 5
      max_connections: 20
      idle_timeout: 300
  replica:
    host: "db-replica.internal"
    port: 5432
    name: "webapp_prod"
    username: "readonly_user"
    password_env: "DB_READONLY_PASSWORD"
    ssl_mode: "require"

# API Configuration
api:
  base_url: "https://api.company.com"
  version: "v2"
  endpoints:
    health: "/health"
    metrics: "/metrics"
    users: "/api/v2/users"
    analytics: "/api/v2/analytics"
  authentication:
    method: "jwt"
    token_expiry: 3600
    refresh_token_expiry: 86400
  rate_limits:
    requests_per_minute: 1000
    burst_limit: 100
  timeout:
    connect: 5
    read: 30
    write: 10

# Feature Flags
features:
  user_registration: true
  email_notifications: true
  analytics: true
  reporting: true
  beta_features: false
  maintenance_mode: false
  debug_mode: false

# Resource Limits
resources:
  cpu:
    limit: "2000m"
    request: "500m"
  memory:
    limit: "2Gi"
    request: "512Mi"
  disk:
    limit: "10Gi"
    request: "5Gi"
  network:
    bandwidth_limit: "100Mbps"

# Security Settings
security:
  encryption:
    algorithm: "AES-256-GCM"
    key_rotation_days: 90
  session:
    timeout: 1800
    secure_cookies: true
    same_site: "strict"
  password_policy:
    min_length: 12
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_symbols: true
    max_age_days: 90
  cors:
    allowed_origins:
      - "https://app.company.com"
      - "https://admin.company.com"
    allowed_methods: ["GET", "POST", "PUT", "DELETE"]
    allowed_headers: ["Content-Type", "Authorization"]

# Logging Configuration
logging:
  level: "INFO"
  format: "json"
  output:
    - type: "file"
      path: "/var/log/webapp/application.log"
      max_size: "100MB"
      max_files: 10
    - type: "stdout"
      format: "text"
  rotation:
    policy: "daily"
    retention_days: 30
  structured_logging: true
  correlation_id: true

# Monitoring and Metrics
monitoring:
  enabled: true
  metrics:
    port: 9090
    path: "/metrics"
    interval: 30
  health_checks:
    liveness:
      path: "/health/live"
      interval: 10
      timeout: 5
    readiness:
      path: "/health/ready"
      interval: 5
      timeout: 3
  alerts:
    error_rate_threshold: 5.0
    response_time_threshold: 1000
    cpu_threshold: 80.0
    memory_threshold: 85.0

# Environment-specific overrides
environments:
  development:
    database:
      primary:
        host: "localhost"
        name: "webapp_dev"
    features:
      debug_mode: true
      beta_features: true
    logging:
      level: "DEBUG"
  
  staging:
    database:
      primary:
        host: "db-staging.internal"
        name: "webapp_staging"
    features:
      beta_features: true
    
  production:
    security:
      session:
        timeout: 900
    monitoring:
      alerts:
        error_rate_threshold: 1.0
